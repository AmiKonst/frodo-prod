{"version":3,"file":"ModalGallery-BMWXrbNE.js","sources":["../../shared/components/modals/ModalGallery.vue"],"sourcesContent":["<template>\r\n    <BaseModal\r\n        :name=\"props.name\"\r\n        :full=\"true\"\r\n        :mobileMode=\"true\"\r\n        :closeOutside=\"true\"\r\n    >\r\n        <template #content>\r\n            <div class=\"gallery-wrapper\">\r\n\r\n                <div\r\n                    class=\"slides\"\r\n                    :style=\"{ transform: `translateX(${ -data.currentIndex * 100 }% )` }\"\r\n                    v-touch:swipe.left=\"next\"\r\n                    v-touch:swipe.right=\"prev\"\r\n                >\r\n\r\n                    <div\r\n                        class=\"slide\"\r\n                        v-for=\"(img, id) in data.imgs\"\r\n                        :key=\"id\"\r\n                    >\r\n                            <!-- v-touch:swipe.down=\"close\" -->\r\n                        <div\r\n                            class=\"zoom-container\"\r\n                            ref=\"zoomArea\"\r\n                            v-touch:pinch.stop.prevent=\"onPinch\"\r\n                            v-touch:pinchend=\"onPinchEnd\"\r\n                            v-touch:pan.stop=\"onPan\"\r\n                            v-touch:pan.end=\"onPanEnd\"\r\n                            :class=\"{ loading: data.loading }\"\r\n                            :style=\"{\r\n                                transform: `translate(${data.x}px, ${data.y}px) scale(${data.scale})`\r\n                            }\"\r\n                        >\r\n                            <Loader class=\"opacity-mode\" v-if=\"data.loading\" />\r\n\r\n                            <Transition name=\"fade\">\r\n                                <img :src=\"`${baseUrl}${img.original || img.resized}`\"\r\n                                    v-show=\"!data.loading\"\r\n                                    @load=\"onImageLoad\"\r\n                                />\r\n                            </Transition>\r\n                        </div>\r\n                    </div>\r\n\r\n                </div>\r\n            </div>\r\n        </template>\r\n    </BaseModal>\r\n</template>\r\n\r\n<script setup>\r\nimport { onMounted, reactive, ref } from 'vue';\r\nimport BaseModal from 'ðŸ”—/components/modals/BaseModal.vue';\r\nimport Loader from 'ðŸ”—/components/ui/Loader.vue';\r\nimport stores from '@/stores';\r\n\r\nconst modals = stores.modals();\r\n\r\nconst props = defineProps({\r\n    name: { type: String, default: 'gallery' }\r\n});\r\n\r\nconst baseUrl = import.meta.env.VITE_APP_FILES_URL;\r\n\r\nconst data = reactive({\r\n    imgs: [],\r\n    currentIndex: 0,\r\n    scale: 1,\r\n    baseScale: 1,\r\n    loading: true,\r\n    x: 0,\r\n    y: 0\r\n});\r\n\r\nconst basePos = { x: 0, y: 0 };\r\n\r\n\r\nconst close = () => {\r\n    modals.close(props.name);\r\n};\r\n\r\nconst next = () => {\r\n    if (data.currentIndex < data.imgs.length - 1) {\r\n        data.currentIndex += 1;\r\n        resetZoom();\r\n        data.loading = true;\r\n    }\r\n};\r\n\r\nconst prev = () => {\r\n    if (data.currentIndex > 0) {\r\n        data.currentIndex -= 1;\r\n        resetZoom();\r\n        data.loading = true;\r\n    }\r\n};\r\n\r\nconst onImageLoad = () => {\r\n    data.loading = false;\r\n};\r\n\r\nconst onPinch = (e) => {\r\n    console.log('>>', e)\r\n    data.scale = data.baseScale * e.scale;\r\n\r\n    if (data.scale < 1) {\r\n        data.scale = 1;\r\n    }\r\n\r\n    if (data.scale > 4) {\r\n        data.scale = 4;\r\n    }\r\n};\r\n\r\nconst onPinchEnd = () => {\r\n    data.baseScale = data.scale;\r\n};\r\n\r\nconst onPan = (e) => {\r\n    if (data.scale <= 1) {\r\n        return;\r\n    }\r\n\r\n    data.x = basePos.x + e.deltaX;\r\n    data.y = basePos.y + e.deltaY;\r\n};\r\n\r\nconst onPanEnd = () => {\r\n    basePos.x = data.x;\r\n    basePos.y = data.y;\r\n    data.baseScale = data.scale;\r\n};\r\n\r\nconst resetZoom = () => {\r\n    data.scale = 1;\r\n    data.baseScale = 1;\r\n\r\n    data.x = 0;\r\n    data.y = 0;\r\n    basePos.x = 0;\r\n    basePos.y = 0;\r\n};\r\n\r\nonMounted(() => {\r\n    const payload = modals.getData(props.name);\r\n\r\n    if (payload?.imgs?.length) {\r\n        data.imgs = payload.imgs;\r\n    }\r\n});\r\n</script>\r\n\r\n<style scoped lang=\"scss\">\r\n.gallery-wrapper {\r\n    position: relative;\r\n    width: 100%;\r\n    height: 100%;\r\n    overflow: hidden;\r\n    min-height: 100vh;\r\n\r\n    .slides {\r\n        display: flex;\r\n        width: 100%;\r\n        height: 100%;\r\n        transition: transform 0.25s ease;\r\n        min-height: 100vh;\r\n        .slide {\r\n            flex: 0 0 100%;\r\n            display: flex;\r\n            justify-content: center;\r\n            align-items: center;\r\n            overflow: hidden;\r\n            .zoom-container {\r\n                touch-action: none;\r\n                will-change: transform;\r\n                transition: transform 0.1s ease;\r\n                &.loading {\r\n                    min-width: 100%;\r\n                    min-height: 100%;\r\n                }\r\n\r\n                img {\r\n                    max-width: 100%;\r\n                    max-height: 100%;\r\n                    user-select: none;\r\n                    pointer-events: none;\r\n                }\r\n\r\n                .opacity-mode {\r\n                    user-select: none;\r\n                    pointer-events: none;\r\n                    position: absolute;\r\n                    top: 0;\r\n                    left: 0;\r\n                    right: 0;\r\n                    bottom: 25%;\r\n                    height: auto;\r\n                }\r\n\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\n.fade-enter-from, .fade-leave-to {\r\n    opacity: 0;\r\n}\r\n.fade-enter-to, .fade-leave-from {\r\n    opacity: 1;\r\n}\r\n.fade-enter-active, .fade-leave-active {\r\n    transition: opacity 0.4s ease;\r\n}\r\n</style>\r\n"],"names":[],"mappings":"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"}