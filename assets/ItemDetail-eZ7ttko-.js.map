{"version":3,"file":"ItemDetail-eZ7ttko-.js","sources":["../../shared/components/ui/ItemDetail.vue"],"sourcesContent":["<template>\r\n    <div \r\n        class=\"detail-item\"\r\n    >\r\n        <div \r\n            class=\"background\"\r\n            :class=\"{\r\n                'with-shadow': props.invertShadow !== null,\r\n                'invert-shadow': !!props.invertShadow\r\n            }\"\r\n            :style=\"{\r\n                opacity: backgroundOpacity,\r\n                'aspect-ratio': props.aspectRatio,\r\n                height: props.previewHeight ? props.previewHeight + 'px' : 'auto'\r\n            }\"\r\n        >\r\n            <slot name=\"background\"></slot>\r\n        </div>\r\n\r\n        <div class=\"box\">\r\n            <div \r\n                class=\"preview\"\r\n                :style=\"{\r\n                    opacity: 1,\r\n                    'aspect-ratio': props.aspectRatio,\r\n                    height: props.previewHeight ? props.previewHeight + 'px' : 'auto'\r\n                }\"\r\n            >\r\n                <div \r\n                    class=\"wrapper\"\r\n                    :style=\"{ opacity: wrapperOpacity }\"\r\n                >\r\n                    <div class=\"toolbar\">\r\n                        <slot name=\"toolbar\"></slot>\r\n                    </div>\r\n\r\n                    <slot name=\"preview\"></slot>\r\n                </div>\r\n            </div>\r\n\r\n            <div \r\n                class=\"detail\" \r\n                ref=\"detail\"\r\n            >\r\n                <slot name=\"detail\"></slot>\r\n            </div>\r\n        </div>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\n    // import IconButton from 'ðŸ”—/components/ui/IconButton.vue';\r\n    import { ref, reactive, computed, onMounted, onBeforeUnmount } from \"vue\";\r\n    import stores from '@/stores';\r\n\r\n    const others = stores.others();\r\n\r\n    const props = defineProps({\r\n        previewHeight: { type: Number, default: 384 },\r\n        aspectRatio: { type: [String, null], default: null },\r\n        invertShadow: { type: [Boolean, null], default: null },\r\n\r\n    });\r\n\r\n    const data = reactive({\r\n        mode: 'preview'\r\n    });\r\n\r\n\r\n    const emit = defineEmits(['mode']);\r\n\r\n    const detail = ref(null);\r\n\r\n    const scrollTop = ref(0);\r\n    const scrollDirection = ref(0);\r\n\r\n\r\n    const progress = computed(() =>\r\n        Math.min(1, scrollTop.value / (props.previewHeight || detail?.value?.clientWidth))\r\n    );\r\n\r\n    // Opacity\r\n        const wrapperOpacity = computed(() => 1 - progress.value);\r\n        const backgroundOpacity = computed(() => 1 - progress.value);\r\n\r\n    let lastY = 0;\r\n    const onScroll = (e) => {\r\n        const y = e.target.scrollTop;\r\n        scrollDirection.value = y - lastY;\r\n        lastY = y;\r\n\r\n        scrollTop.value = y;\r\n        updateMode();\r\n    }\r\n\r\n    const updateMode = () => {\r\n        const newMode = progress.value >= 1 ? \"detail\" : \"preview\";\r\n        if (newMode !== data.mode) {\r\n            data.mode = newMode;\r\n            emit('mode', newMode);\r\n        }\r\n    }\r\n\r\n\r\n    document.body.classList.add('with-tg-header');\r\n    onMounted(() => {\r\n        document.querySelector('.page').addEventListener('scroll', onScroll);\r\n    });\r\n\r\n    onBeforeUnmount(() => {\r\n        document.body.classList.remove('with-tg-header');\r\n        document.querySelector('.page').removeEventListener('scroll', onScroll);\r\n    });\r\n</script>\r\n\r\n\r\n<style scoped lang=\"scss\">\r\n    .detail-item {\r\n        position: relative;\r\n        // height: 100%;\r\n        width: 100%;\r\n        // overflow-y: auto;\r\n        // scroll-behavior: smooth;\r\n        // min-height: 100%;\r\n        // position: fixed;\r\n        // top: 0;\r\n        // left: 0;\r\n        // right: 0;\r\n        // bottom: var(--nav-height);\r\n\r\n        .background {\r\n            position: fixed;\r\n            top: 0;\r\n            left: 0;\r\n            right: 0;\r\n\r\n            &.with-shadow {\r\n                &:after {\r\n                    content: \"\";\r\n                    inset: 0;\r\n                    position: absolute;\r\n                    pointer-events: none;\r\n                    background: linear-gradient(101deg, var(--white-5) 41%, var(--white-90) 89%);\r\n                }\r\n            }\r\n\r\n            &.invert-shadow {\r\n                &:after {\r\n                    background: linear-gradient(101deg, var(--dark-5) 75%, var(--dark-80) 100%)\r\n                }\r\n            }\r\n        }\r\n\r\n        .box {\r\n            min-height: 100%;\r\n            display: flex;\r\n            flex-direction: column;\r\n        }\r\n        .preview {\r\n            position: relative;\r\n            top: 0;\r\n            overflow: hidden;\r\n            pointer-events: none;\r\n            z-index: 1;\r\n\r\n            .toolbar {\r\n                position: absolute;\r\n                top: calc(var(--tg-safe-area-inset-top, 0px) + var(--tg-content-safe-area-inset-top, 0px) + 12px);\r\n                right: -4px;\r\n                display: flex;\r\n                flex-direction: column-reverse;\r\n                align-items: center;\r\n                gap: 0px;\r\n            }\r\n\r\n            .wrapper {\r\n                position: absolute;\r\n                inset: 0;\r\n                padding: 16px;\r\n                display: flex;\r\n                flex-direction: column;\r\n                justify-content: flex-end;\r\n                z-index: 2;\r\n                pointer-events: auto;\r\n                gap: 16px;\r\n            }\r\n        }\r\n\r\n        .detail {\r\n            flex: 1;\r\n            display: flex;\r\n            flex-direction: column;\r\n            background: var(--white-500);\r\n            // min-height: 200vh;\r\n            position: relative;\r\n            padding: 32px 0;\r\n            gap: var(--block-gap);\r\n\r\n            &:before {\r\n                content: '';\r\n                position: absolute;\r\n                top: 0;\r\n                left: 0;\r\n                width: 100%;\r\n                height: 36px;\r\n                transform: translateY(-100%);\r\n                background: linear-gradient(to bottom, var(--white-0) 0%, var(--white-500) 100%);\r\n                pointer-events: none;\r\n            }\r\n        }\r\n    }\r\n</style>\r\n"],"names":[],"mappings":";;;;;AAsDA;AACA;;;;;;;;;;;AALc;AACd;AACA,IAGmB,MAAM,CAAC,MAAM,GAAG;AACnC;AACA,IAAI,MAAM,KAAK,GAAG,OAKZ,CAAC;AACP;AACA,IAAI,MAAM,IAAI,GAAG,QAAQ,CAAC;AAC1B,QAAQ,IAAI,EAAE,SAAS;AACvB,KAAK,CAAC,CAAC;AACP;AACA;AACA,IAAI,MAAM,IAAI,GAAG,MAAqB,CAAC;AACvC;AACA,IAAI,MAAM,MAAM,GAAG,GAAG,CAAC,IAAI,CAAC,CAAC;AAC7B;AACA,IAAI,MAAM,SAAS,GAAG,GAAG,CAAC,CAAC,CAAC,CAAC;AAC7B,IAAI,MAAM,eAAe,GAAG,GAAG,CAAC,CAAC,CAAC,CAAC;AACnC;AACA;AACA,IAAI,MAAM,QAAQ,GAAG,QAAQ,CAAC;AAC9B,QAAQ,IAAI,CAAC,GAAG,CAAC,CAAC,EAAE,SAAS,CAAC,KAAK,IAAI,KAAK,CAAC,aAAa,IAAI,MAAM,EAAE,KAAK,EAAE,WAAW,CAAC,CAAC;AAC1F,KAAK,CAAC;AACN;AACA;AACA,QAAQ,MAAM,cAAc,GAAG,QAAQ,CAAC,MAAM,CAAC,GAAG,QAAQ,CAAC,KAAK,CAAC,CAAC;AAClE,QAAQ,MAAM,iBAAiB,GAAG,QAAQ,CAAC,MAAM,CAAC,GAAG,QAAQ,CAAC,KAAK,CAAC,CAAC;AACrE;AACA,IAAI,IAAI,KAAK,GAAG,CAAC,CAAC;AAClB,IAAI,MAAM,QAAQ,GAAG,CAAC,CAAC,KAAK;AAC5B,QAAQ,MAAM,CAAC,GAAG,CAAC,CAAC,MAAM,CAAC,SAAS,CAAC;AACrC,QAAQ,eAAe,CAAC,KAAK,GAAG,CAAC,GAAG,KAAK,CAAC;AAC1C,QAAQ,KAAK,GAAG,CAAC,CAAC;AAClB;AACA,QAAQ,SAAS,CAAC,KAAK,GAAG,CAAC,CAAC;AAC5B,QAAQ,UAAU,EAAE,CAAC;AACrB,IAAI,EAAC;AACL;AACA,IAAI,MAAM,UAAU,GAAG,MAAM;AAC7B,QAAQ,MAAM,OAAO,GAAG,QAAQ,CAAC,KAAK,IAAI,CAAC,GAAG,QAAQ,GAAG,SAAS,CAAC;AACnE,QAAQ,IAAI,OAAO,KAAK,IAAI,CAAC,IAAI,EAAE;AACnC,YAAY,IAAI,CAAC,IAAI,GAAG,OAAO,CAAC;AAChC,YAAY,IAAI,CAAC,MAAM,EAAE,OAAO,CAAC,CAAC;AAClC,QAAQ,CAAC;AACT,IAAI,EAAC;AACL;AACA;AACA,IAAI,QAAQ,CAAC,IAAI,CAAC,SAAS,CAAC,GAAG,CAAC,gBAAgB,CAAC,CAAC;AAClD,IAAI,SAAS,CAAC,MAAM;AACpB,QAAQ,QAAQ,CAAC,aAAa,CAAC,OAAO,CAAC,CAAC,gBAAgB,CAAC,QAAQ,EAAE,QAAQ,CAAC,CAAC;AAC7E,IAAI,CAAC,CAAC,CAAC;AACP;AACA,IAAI,eAAe,CAAC,MAAM;AAC1B,QAAQ,QAAQ,CAAC,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC,gBAAgB,CAAC,CAAC;AACzD,QAAQ,QAAQ,CAAC,aAAa,CAAC,OAAO,CAAC,CAAC,mBAAmB,CAAC,QAAQ,EAAE,QAAQ,CAAC,CAAC;AAChF,IAAI,CAAC,CAAC,CAAC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;"}