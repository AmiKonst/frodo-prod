{"version":3,"file":"ModalStudioAuth-B6a2KXCN.js","sources":["../../shared/components/ui/Code.vue","../../src/pages/Settings/modals/ModalStudioAuth.vue"],"sourcesContent":["<template>\r\n    <div class=\"code-inputs\">\r\n        <input\r\n            v-for=\"(digit, id) in data.values\"\r\n            :key=\"id\"\r\n            :ref=\"el => data.inputs[id] = el\"\r\n            placeholder=\" \"\r\n            type=\"text\"\r\n            maxlength=\"1\"\r\n            @input=\"onInput($event, id)\"\r\n            @focus=\"focusInput(id)\"\r\n            @keydown=\"onKeydown(id, $event)\"\r\n        />\r\n      </div>\r\n</template>\r\n\r\n<script setup>\r\n    import { ref, watch, reactive, onMounted } from 'vue';\r\n    const props = defineProps({\r\n        count: { type: Number, default: 6 }\r\n    });\r\n\r\n    const data = reactive({\r\n        values: ref(Array(props.count).fill('')),\r\n        inputs: {}\r\n    });\r\n\r\n    const emit = defineEmits(['change']);\r\n\r\n    const onInput = (e, id) => {\r\n        if (/^[0-9]$/.test(e.target.value)) {\r\n            data.values[id] = +e.target.value;\r\n            nextInput(id);\r\n        } else {\r\n            data.values[id] = '';\r\n        }\r\n    };\r\n\r\n    const focusInput = (id) => {\r\n        if (data.inputs[id]) {\r\n            data.inputs[id].focus();\r\n        }\r\n    };\r\n\r\n    const nextInput = (id) => {\r\n        if (id + 1 < props.count) {\r\n            focusInput(id + 1);\r\n        }\r\n    };\r\n\r\n    const onKeydown = (id, event) => {\r\n        if (event.key === 'Backspace' && !data.values[id] && id > 0) {\r\n            data.values[id - 1] = '';\r\n            focusInput(id - 1);\r\n        }\r\n    };\r\n\r\n    watch(data.values, (newValues) => {\r\n        if (data.values.every(item => /^[0-9]$/.test(item))) {\r\n            emit('change', data.values.join(''));\r\n        } else {\r\n            emit('change', null);\r\n        }\r\n    });\r\n\r\n    onMounted(() => {\r\n        focusInput(0);\r\n    })\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n    .code-inputs {\r\n        display: flex;\r\n        flex-direction: row;\r\n        gap: 10px;\r\n\r\n        input {\r\n            @include input;\r\n            font: var(--font-h5);\r\n            font-weight: bold;\r\n            padding: 0;\r\n            text-align: center;\r\n\r\n            &:focus,\r\n            &:hover,\r\n            &:not(:placeholder-shown) {\r\n                padding-top: 0;\r\n                padding-bottom: 2px;\r\n            }\r\n        }  \r\n    }\r\n</style>\r\n","<template>\r\n    <BaseModal\r\n        :isLoading=\"data.loading\"\r\n        :name=\"props.name\"\r\n        :mobileMode=\"true\"\r\n        :closeOutside=\"true\"\r\n        class=\"modal-studio-auth\"\r\n    >\r\n        <template v-slot:title>{{ t('modals.studio-auth.title') }}</template>\r\n\r\n        <template v-slot:content>\r\n            <span class=\"description\" v-html=\"t('modals.studio-auth.description')\"></span>\r\n\r\n            <Code @change=\"setCode\" />\r\n\r\n            <Button\r\n                @click=\"verify\"\r\n                :disabled=\"!data.code\"\r\n                class=\"size-l\"\r\n                :name=\"t('modals.studio-auth.verify')\"\r\n            />\r\n        </template>\r\n    </BaseModal>\r\n</template>\r\n\r\n<script setup>\r\nimport { useI18n } from 'vue-i18n';\r\nimport { onMounted, reactive } from 'vue';\r\nimport { message } from 'ðŸ”—/utils/utils';\r\n\r\nimport BaseModal from 'ðŸ”—/components/modals/BaseModal.vue';\r\nimport Button from 'ðŸ”—/components/ui/Button.vue';\r\nimport Code from 'ðŸ”—/components/ui/Code.vue';\r\n\r\nimport stores from '@/stores';\r\nconst modals = stores.modals();\r\nconst user = stores.user();\r\n\r\nconst { t } = useI18n();\r\n\r\nconst data = reactive({\r\n    once: false,\r\n    loading: false,\r\n    code: ''\r\n});\r\n\r\nconst props = defineProps({\r\n    name: {\r\n        type: String,\r\n        default: 'sudio-auth'\r\n    }\r\n});\r\n\r\nconst setCode = (code) => {\r\n    data.code = code;\r\n\r\n    if (data.code && !data.once) {\r\n        data.once = true;\r\n        verify();\r\n    }\r\n}\r\n\r\nconst verify = async () => {\r\n    data.loading = true;\r\n\r\n    const payload = await user.externalLogin(data.code);\r\n\r\n    if (!payload) {\r\n        setTimeout(() => {\r\n            message.info(t('modals.studio-auth.fail.title'))\r\n            data.loading = false;\r\n        }, 500);\r\n        return;\r\n    }\r\n\r\n    setTimeout(() => {\r\n        modals.open('success', {\r\n            data: {\r\n                title: t('modals.studio-auth.done.title'),\r\n                description: t('modals.studio-auth.done.description'),\r\n                close: t('modals.studio-auth.done.close')\r\n            },\r\n            quietClose: true\r\n        });\r\n\r\n        modals.close(props.name);\r\n    }, 1000);\r\n}\r\n\r\nonMounted(async () => {\r\n    data.loading = false;\r\n});\r\n</script>\r\n\r\n<style lang=\"scss\">\r\n    .modal-studio-auth {\r\n        max-width: 420px;\r\n    }\r\n</style>\r\n\r\n<style lang=\"scss\" scoped>\r\n    .description {\r\n        padding: 0;\r\n        text-align: center;\r\n        font: var(--font-body-2);\r\n        color: var(--dark-500);\r\n    }\r\n\r\n    .size-l {\r\n        margin-top: 10px;\r\n    }\r\n</style>\r\n"],"names":[],"mappings":"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"}