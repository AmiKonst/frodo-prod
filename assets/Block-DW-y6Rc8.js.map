{"version":3,"file":"Block-DW-y6Rc8.js","sources":["../../shared/components/blocks/Block.vue"],"sourcesContent":["<template>\r\n    <div class=\"block\">\r\n        <TitleWithButtons\r\n            v-if=\"props.title\"\r\n            :title=\"props.title\"\r\n            :items=\"props.buttons\"\r\n        />\r\n\r\n        <template v-if=\"props.type === 'list'\">\r\n            <div class=\"items-list\">\r\n                <ul class=\"items\" v-if=\"data.items.length\">\r\n                    <li v-for=\"(item, id) in data.items\"\r\n                        :class=\"{ active: props.id && (props.id === item.code || props.id === item.id) }\"\r\n                        @click=\"onClick(item)\"\r\n                    >\r\n                        <slot name=\"list-item\" :item=\"item\" />\r\n                    </li>\r\n                </ul>\r\n                <ul class=\"items\" v-if=\"props.skeleton && data.loading\">\r\n                    <li v-for=\"(item, id) in Array.from({ length: props.skeletonCount }, () => ({ code: Math.random() }))\">\r\n                        <slot name=\"list-skeleton\"/>\r\n                    </li>\r\n                </ul>\r\n\r\n                <Button :loading=\"data.loading\"\r\n                    class=\"tertiary size-l\"\r\n                    :name=\"t(`blocks.${props.code}.load`)\"\r\n                    v-if=\"props.loadMore && ((data.loading && !props.skeleton) || (data.items.length < data.total))\"\r\n                    @click=\"getItems\"\r\n                />\r\n\r\n                <EmptyLabel\r\n                    v-if=\"!data.items.length && !data.loading\"\r\n                    class=\"empty\"\r\n                    :title=\"props.empty?.title || t('common.empty.title')\"\r\n                    :description=\"props.empty?.description || t('common.empty.description')\"\r\n                />\r\n            </div>\r\n        </template>\r\n\r\n        <template v-if=\"props.type === 'row'\">\r\n            <div class=\"slider-box\">\r\n                <Slider\r\n                    v-if=\"data.items.length && !data.loading\"\r\n                    :colPreloadCount=\"Math.ceil(props.take / props.itemsInCol)\"\r\n                    :itemsInCol=\"props.itemsInCol\"\r\n                    :items=\"data.items\"\r\n                    v-bind=\"props.sliderProps\"\r\n                    ref=\"sliderRef\"\r\n                >\r\n                    <template #default=\"{ item }\">\r\n                        <div class=\"slide\" @click=\"onClick(item)\">\r\n                            <slot name=\"row-item\" :item=\"item\" />\r\n                        </div>\r\n                    </template>\r\n                </Slider>\r\n\r\n                <Slider\r\n                    v-if=\"data.loading\"\r\n                    :colPreloadCount=\"Math.ceil(props.take / props.itemsInCol)\"\r\n                    :itemsInCol=\"props.itemsInCol\"\r\n                    :items=\"Array.from({ length: props.skeletonCount }, () => ({ code: Math.random() }))\"\r\n                    v-bind=\"props.sliderProps\"\r\n                    ref=\"sliderRef\"\r\n                >\r\n                    <template #default=\"{ item }\">\r\n                        <div class=\"slide\" @click=\"onClick(item)\">\r\n                            <slot name=\"row-skeleton\" />\r\n                        </div>\r\n                    </template>\r\n                </Slider>\r\n\r\n                <EmptyLabel\r\n                    v-if=\"!data.items.length && !data.loading\"\r\n                    class=\"empty\"\r\n                    :title=\"props.empty?.title || t('common.empty.title')\"\r\n                    :description=\"props.empty?.description || t('common.empty.description')\"\r\n                />\r\n            </div>\r\n        </template>\r\n    </div>\r\n</template>\r\n\r\n<script setup>\r\n    import { useI18n } from 'vue-i18n';\r\n    import { onMounted, reactive } from 'vue';\r\n    import api from 'ðŸ”—/api';\r\n    import TitleWithButtons from '@/components/ui/TitleWithButtons.vue';\r\n    import Button from 'ðŸ”—/components/ui/Button.vue';\r\n    import Slider from 'ðŸ”—/components/ui/Slider.vue';\r\n    import EmptyLabel from 'ðŸ”—/components/ui/EmptyLabel.vue';\r\n    import stores from '@/stores';\r\n\r\n    const emit = defineEmits(['change']);\r\n\r\n    const nav = stores.nav();\r\n\r\n\r\n    const { t } = useI18n();\r\n\r\n    const props = defineProps({\r\n        code: { type: String, default: '' },\r\n        empty: { type: Object, default: () => ({}) },\r\n        items: { type: Array, default: () => ([]) },\r\n        title: { type: [Object, String, null], default: null },\r\n        params: { type: Object, default: () => ({}) },\r\n        sort: { type: [Object, null], default: null },\r\n        loadMore: { type: Boolean, default: true },\r\n        skeleton: { type: Boolean, default: false },\r\n        skeletonCount: { type: Number, default: 30 },\r\n        take: { type: Number, default: 30 },\r\n        itemsInCol: { type: Number, default: 1 },\r\n        handler: { type: [String, null], default: () => null },\r\n        type: { type: String, default: 'list' },\r\n        source: { type: [Object, null], default: null },\r\n        id: { type: [String, null], default: null },\r\n        sliderProps: { type: Object, default: () => ({}) },\r\n        buttons: { type: Array, default: () => ([]) },\r\n        folder: { type: [Object, null], default: null },\r\n        getById: { type: [String, null], default: null }\r\n    });\r\n\r\n    const data = reactive({\r\n        items: props.items,\r\n        loading: false,\r\n        skip: props.items?.length || 0,\r\n        total: props.items?.length || 0\r\n    });\r\n\r\n\r\n    const getState = () => ({\r\n        items: data.items,\r\n        total: data.total\r\n    });\r\n\r\n    const getItems = async () => {\r\n        clearTimeout(data.setItemsTimeout);\r\n        data.loading = true;\r\n\r\n        if (!data.skip) {\r\n            data.items = [];\r\n        }\r\n\r\n        let params;\r\n\r\n        if (props.getById) {\r\n            params = props.getById;\r\n        } else {\r\n            params = {\r\n                ...(props.params || {}),\r\n                skip: data.skip,\r\n                take: props.take\r\n            };\r\n\r\n            if (props.sort) {\r\n                params.sort = props.sort.code;\r\n                params.sort_dir = props.sort.direction;\r\n            }\r\n        }\r\n\r\n        const payload = await api[props.source.store]()[props.source.fnName](params) || [];\r\n\r\n        data.setItemsTimeout = setTimeout(() => {\r\n            if (payload?.items?.length) {\r\n                data.items.splice(data.items.length, 0, ...(payload.items || []));\r\n            }\r\n\r\n            data.skip = data.items.length;\r\n            data.total = payload?.total || 0;\r\n\r\n            data.loading = false;\r\n        }, 200);\r\n    };\r\n\r\n    const reload = () => {\r\n        data.skip = 0;\r\n        getItems();\r\n    };\r\n\r\n    const onClick = (item) => {\r\n        emit('change', item);\r\n    }\r\n\r\n    defineExpose({\r\n        reload,\r\n        getState\r\n    });\r\n\r\n    onMounted(() => {\r\n        if (props.source) {\r\n            getItems();\r\n        }\r\n    });\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n    @include default-items-list;\r\n\r\n\r\n    .items-list {\r\n        gap: 8px;\r\n\r\n        .items {\r\n            padding: 0;\r\n            // padding: 16px 0;\r\n            gap: 0;\r\n            & > li {\r\n                // padding-right: 0;\r\n                padding-top: 4px;\r\n                padding-bottom: 4px;\r\n\r\n                &.active {\r\n                    background: var(--light-20);\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    .slider-box {\r\n        width: 100%;\r\n        overflow: hidden;\r\n\r\n        .slider {\r\n            padding: 0px 16px;\r\n            scroll-padding-left: 16px;\r\n            scroll-padding-right: 16px;\r\n        }\r\n\r\n        .loader {\r\n            // min-height: 208px;\r\n            margin: auto;\r\n        }\r\n    }\r\n\r\n    .block {\r\n        padding: 0 0 var(--block-gap);\r\n        display: flex;\r\n        flex-direction: column;\r\n        gap: 32px;\r\n        width: 100%;\r\n        justify-content: start;\r\n\r\n\r\n        .title {\r\n            padding: 0 16px;\r\n        }\r\n\r\n        &.inline {\r\n            .title {\r\n                padding: 0;\r\n            }\r\n\r\n            .items-list {\r\n                .items {\r\n                    & > li {\r\n                        padding: 0;\r\n                    }\r\n                }\r\n            }\r\n\r\n            .slider-box {\r\n                .slider {\r\n                    padding: 0; \r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n\r\n    .direction-rtl {\r\n        .items-list {\r\n            .items {\r\n                & > li {\r\n                    padding-right: 16px;\r\n                    padding-left: 0;\r\n                }\r\n            }\r\n        }\r\n    }\r\n</style>"],"names":[],"mappings":"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"}